(this["webpackJsonpmqtt5-basic-react-web"]=this["webpackJsonpmqtt5-basic-react-web"]||[]).push([[0],{111:function(e,t){},112:function(e,t){},118:function(e,t,c){},119:function(e,t,c){"use strict";c.r(t);var n=c(1),s=c.n(n),a=c(55),o=c.n(a),r=c(4),l=c(2),i=c(23),d=c(0),u=function(e){return Object(d.jsx)("nav",{className:"navbar navbar-expand-md navbar-dark bg-dark",children:Object(d.jsxs)("div",{className:"container-fluid",children:[Object(d.jsx)("div",{className:"navbar-header",children:Object(d.jsx)("span",{className:"navbar-brand",children:"MQTT.js Client for React Web"})}),Object(d.jsx)("div",{className:"collapse navbar-collapse",children:Object(d.jsxs)("ul",{className:"navbar-nav",children:[Object(d.jsx)("li",{className:"nav-item",children:Object(d.jsx)(i.b,{to:"/request_response_pattern",className:"nav-link",children:"Request/Response Pattern"})}),Object(d.jsx)("li",{className:"nav-item",children:Object(d.jsx)(i.b,{to:"/broadcast",className:"nav-link",children:"Boardcast"})})]})})]})})},b=c(6),j=c(123),m=c(24),h=c.n(m),O=c(3),p=s.a.createContext(),x=function(e){return Object(d.jsxs)("div",{className:"mt-2 row",children:[Object(d.jsx)("label",{htmlFor:e.id,className:"col-sm-2 col-form-label",children:e.label}),Object(d.jsx)("div",{className:"col-sm-10",children:Object(d.jsx)("input",{id:e.id,className:"form-control",value:e.value,readOnly:e.readOnly,onChange:function(t){e.onChange(t.target.value)}})})]})},v=function(e){var t=s.a.useContext(p),c=t.client,n=t.connected,a=s.a.useState("request/echo"),o=Object(r.a)(a,2),l=o[0],i=o[1],u=s.a.useState(),m=Object(r.a)(u,2),v=m[0],f=m[1],g=s.a.useState("GoGoGo!"),w=Object(r.a)(g,2),y=w[0],S=w[1],N=s.a.useState("".concat(Object(j.a)())),q=Object(r.a)(N,2),T=q[0],k=q[1],C=s.a.useState(!1),M=Object(r.a)(C,2),R=M[0],Q=M[1],W=s.a.useState([]),I=Object(r.a)(W,2),L=I[0],D=I[1],F=s.a.useRef(L),H=s.a.useRef(1);s.a.useEffect((function(){console.log("reset response topic with new clientId"),null!==c&&c.connected&&f("response/".concat(c.options.clientId,"/echo"))}),[c,n]);var Y=function(e,t){var c={cnt:H.current++,ts:h()().format("HH:mm:ss.SSSSS"),event:e,log:t};F.current=[c].concat(Object(b.a)(F.current)).slice(0,19),D(F.current)},P=function(e,t,c){Y("message",t)},U=function(e){Y("packetsend",JSON.stringify(e))},_=function(e){Y("packetreceive",JSON.stringify(e))},B=function(){if(R){c.unsubscribe(v,{},(function(e){c.removeAllListeners("message"),c.removeAllListeners("packetsend"),c.removeAllListeners("packetreceive"),Q(!1)}))}};return Object(d.jsxs)("div",{children:[Object(d.jsx)(O.a,{when:R,message:function(e,t){return B(),!0}}),Object(d.jsx)("p",{children:"This page demonstrates how to use request response pattern"}),Object(d.jsx)(x,{id:"requestTopic",label:"Request Topic",value:l,readOnly:R,onChange:i}),Object(d.jsx)(x,{id:"responseTopic",label:"Response Topic",value:v,readOnly:R,onChange:f}),Object(d.jsx)(x,{id:"message",label:"Message",value:y,onChange:S}),Object(d.jsx)(x,{id:"correlationData",label:"Correlation Data",value:T,readOnly:!0,onChange:k}),Object(d.jsxs)("div",{className:"mt-2",children:[Object(d.jsx)("button",{className:"btn btn-primary me-2",disabled:!(null!==c&&c.connected&&!R),onClick:function(){if(!R){H.current=1,F.current=[],D(F.current),c.on("message",P),c.on("packetsend",U),c.on("packetreceive",_);c.subscribe(v,{},(function(e,t){Q(!0)}))}},children:"Subscribe"}),Object(d.jsx)("button",{className:"btn btn-primary me-2",disabled:!R,onClick:B,children:"Unsubscribe"}),Object(d.jsx)("button",{className:"btn btn-primary me-2",disabled:!R,onClick:function(){if(R){var e={retain:!0,properties:{responseTopic:v,correlationData:T,payloadFormatIndicator:!0,contentType:"text/plain"}};c.publish(l,y,e,(function(){k("".concat(Object(j.a)()))}))}},children:"Send"})]}),0===L.length?Object(d.jsx)(d.Fragment,{}):Object(d.jsxs)("div",{className:"mt-2",children:[Object(d.jsx)("h5",{children:"Sent/Received package/message"}),Object(d.jsxs)("table",{className:"table table-striped table-sm",children:[Object(d.jsx)("thead",{children:Object(d.jsxs)("tr",{children:[Object(d.jsx)("th",{scope:"col",children:"#"}),Object(d.jsx)("th",{scope:"col",children:"time"}),Object(d.jsx)("th",{scope:"col",children:"event"}),Object(d.jsx)("th",{scope:"col",children:"log"})]})}),Object(d.jsx)("tbody",{children:L.map((function(e,t){return Object(d.jsxs)("tr",{children:[Object(d.jsx)("th",{scope:"row",children:e.cnt}),Object(d.jsx)("td",{children:e.ts}),Object(d.jsx)("td",{children:e.event}),Object(d.jsx)("td",{children:e.log})]},t)}))})]})]})]})},f=c(58),g=function(e){var t=[{url:"ws://test.mosquitto.org:8080/mqtt",desc:"test.mosquitto.org - MQTT over WebSockets, unencrypted, unauthenticated",username:"",password:""},{url:"wss://test.mosquitto.org:8081/mqtt",desc:"test.mosquitto.org - MQTT over WebSockets, encrypted, unauthenticated",username:"",password:""},{url:"ws://test.mosquitto.org:8090/mqtt",desc:"test.mosquitto.org - MQTT over WebSockets, unencrypted, authenticated (rw)",username:"rw",password:"readwrite"},{url:"ws://test.mosquitto.org:8090/mqtt",desc:"test.mosquitto.org - MQTT over WebSockets, unencrypted, authenticated (ro)",username:"ro",password:"readonly"},{url:"ws://test.mosquitto.org:8090/mqtt",desc:"test.mosquitto.org - MQTT over WebSockets, unencrypted, authenticated (wo)",username:"wo",password:"writeonly"},{url:"wss://test.mosquitto.org:8091/mqtt",desc:"test.mosquitto.org - MQTT over WebSockets, encrypted, authenticated (rw)",username:"rw",password:"readwrite"},{url:"wss://test.mosquitto.org:8091/mqtt",desc:"test.mosquitto.org - MQTT over WebSockets, encrypted, authenticated (ro)",username:"ro",password:"readonly"},{url:"wss://test.mosquitto.org:8091/mqtt",desc:"test.mosquitto.org - MQTT over WebSockets, encrypted, authenticated (wo)",username:"wo",password:"writeonly"},{url:"ws://localhost:8000/mqtt",desc:"My local HiveMQ - MQTT over WebSockets, unencrypted, authenticated",username:"user1",password:"hm93bqCj6xR562U"},{url:"wss://localhost:8001/mqtt",desc:"My local HiveMQ - MQTT over WebSockets, encrypted, authenticated",username:"user1",password:"hm93bqCj6xR562U"}],c=s.a.useState("webclient_".concat(Math.random().toString(16).substr(2,8))),n=Object(r.a)(c,2),a=n[0],o=(n[1],s.a.useState(t[9].url)),l=Object(r.a)(o,2),i=l[0],u=l[1],b=s.a.useState(t[9].username),j=Object(r.a)(b,2),m=j[0],h=j[1],O=s.a.useState(t[9].password),v=Object(r.a)(O,2),g=v[0],y=v[1],S=s.a.useRef(null),N=s.a.useContext(p).connected;return s.a.useEffect((function(){null===S.current&&(S.current=new f.a(document.getElementById("connectDialogue"),{backdrop:"static",keyboard:!1,focus:!0}))}),[]),s.a.useEffect((function(){N?S.current.hide():S.current.show()}),[N]),Object(d.jsx)("div",{className:"modal",tabIndex:"-1",id:"connectDialogue",children:Object(d.jsx)("div",{className:"modal-dialog modal-lg modal-dialog-centered",children:Object(d.jsxs)("div",{className:"modal-content",children:[Object(d.jsx)("div",{className:"modal-header",children:Object(d.jsx)("h5",{className:"modal-title",children:"MQTT.js client properties"})}),Object(d.jsxs)("div",{className:"modal-body",children:[Object(d.jsx)(x,{id:"clientId",label:"Client ID",value:a,readOnly:!0}),Object(d.jsx)(w,{id:"profile",label:"Profile",data:t,selected:9,onChange:function(e){u(e.url),h(e.username),y(e.password)}}),Object(d.jsx)(x,{id:"brokerUrl",label:"BrokerUrl",value:i,onChange:u}),Object(d.jsx)(x,{id:"username",label:"Username",value:m,onChange:h}),Object(d.jsx)(x,{id:"password",label:"Password",value:g,onChange:y})]}),Object(d.jsx)("div",{className:"modal-footer",children:Object(d.jsx)("button",{type:"button",className:"btn btn-primary",onClick:function(){e.connect(a,i,m,g)},children:"Connect"})})]})})})},w=function(e){var t=s.a.useState(e.selected),c=Object(r.a)(t,2),n=c[0],a=c[1];return Object(d.jsxs)("div",{className:"mt-2 row",children:[Object(d.jsx)("label",{htmlFor:e.id,className:"col-sm-2 col-form-label",children:e.label}),Object(d.jsx)("div",{className:"col-sm-10",children:Object(d.jsx)("select",{id:e.id,className:"form-select",value:n,onChange:function(t){a(t.target.value),e.onChange(e.data[t.target.value])},children:e.data.map((function(e,t){return Object(d.jsx)("option",{value:t,children:e.desc},t)}))})})]})},y=function(e){var t=s.a.useContext(p),c=t.client,a=(t.connected,Object(n.useState)("measure/latency")),o=Object(r.a)(a,2),l=o[0],i=o[1],u=s.a.useState(!1),j=Object(r.a)(u,2),m=j[0],v=j[1],f=s.a.useState([]),g=Object(r.a)(f,2),w=g[0],y=g[1],S=s.a.useRef(w),N=s.a.useRef(1),q=function(e,t,c){var n=JSON.parse(t),s=h()(n.sentTime),a=h()(),o=a.valueOf()-s.valueOf();!function(e){S.current=[e].concat(Object(b.a)(S.current)).slice(0,19),y(S.current)}({cnt:n.count,sent:s.format("D/M/YYYY[T]HH:mm:ss.SSSSS"),recv:a.format("D/M/YYYY[T]HH:mm:ss.SSSSS"),delay:o})},T=function(){if(m){c.unsubscribe(l,{},(function(e){c.removeAllListeners("message"),v(!1)}))}};return Object(d.jsxs)("div",{children:[Object(d.jsx)(O.a,{when:m,message:function(e,t){return T(),!0}}),Object(d.jsx)(x,{id:"broadcastTopic",label:"Boardcast Topic",value:l,readOnly:m,onChange:i}),Object(d.jsxs)("div",{className:"mt-2",children:[Object(d.jsx)("button",{className:"btn btn-primary me-2",disabled:!(null!==c&&c.connected&&!m),onClick:function(){if(!m){N.current=1,S.current=[],y(S.current),c.on("message",q);c.subscribe(l,{},(function(e,t){v(!0)}))}},children:"Subscribe"}),Object(d.jsx)("button",{className:"btn btn-primary me-2",disabled:!m,onClick:T,children:"Unsubscribe"})]}),0==w.length?Object(d.jsx)(d.Fragment,{}):Object(d.jsxs)("div",{className:"mt-2",children:[Object(d.jsx)("h5",{children:"Received message"}),Object(d.jsxs)("table",{className:"table table-striped table-sm",children:[Object(d.jsx)("thead",{children:Object(d.jsxs)("tr",{children:[Object(d.jsx)("th",{scope:"col",children:"#"}),Object(d.jsx)("th",{scope:"col",children:"sent time"}),Object(d.jsx)("th",{scope:"col",children:"received time"}),Object(d.jsx)("th",{scope:"col",children:"delay"})]})}),Object(d.jsx)("tbody",{children:w.map((function(e,t){return Object(d.jsxs)("tr",{children:[Object(d.jsx)("td",{scope:"row",children:e.cnt}),Object(d.jsx)("td",{children:e.sent}),Object(d.jsx)("td",{children:e.recv}),Object(d.jsx)("td",{children:e.delay})]},t)}))})]})]})]})},S=c(68),N=function(e,t){var c=t.type,n=t.payload;return"client/init"===c?Object(l.a)(Object(l.a)({},e),{},{client:n}):"client/close"===c||"client/end"===c?Object(l.a)(Object(l.a)({},e),{},{client:null}):Object(l.a)({},e)},q=function(e){var t=s.a.useReducer(N,{client:null}),c=Object(r.a)(t,2),n=c[0],a=c[1];return Object(d.jsx)("div",{className:"container",children:Object(d.jsx)(p.Provider,{value:{client:n.client,connected:null!==n.client&&n.client.connected},children:Object(d.jsxs)(i.a,{children:[Object(d.jsx)(u,{}),Object(d.jsxs)(O.e,{children:[Object(d.jsx)(O.c,{path:"/",exact:!0,children:Object(d.jsx)(O.b,{to:"/request_response_pattern"})}),Object(d.jsx)(O.c,{path:"/request_response_pattern",children:Object(d.jsx)(v,{})}),Object(d.jsx)(O.c,{path:"/broadcast",children:Object(d.jsx)(y,{})})]}),Object(d.jsx)(g,{connect:function(e,t,c,s){var o=n.client;if(null!==o&&o.connected)throw new Error("Client has already been connected");(o=S.connect(t,{clientId:e,reconnectPeriod:0,protocolVersion:5,username:c,password:s})).on("error",(function(e){throw e})),o.on("connect",(function(e){a({type:"client/connect",payload:e})})),o.on("disconnect",(function(e){console.log("client disconnect")})),o.on("offline",(function(){console.log("client offline")})),o.on("reconnect",(function(){console.log("client reconnect")})),o.on("close",(function(){console.log("client close"),a({type:"client/close",payload:o})})),o.on("end",(function(){console.log("client end"),a({type:"client/end",payload:o})})),o.on("newListener",(function(){console.log("newListener")})),o.on("removeListener",(function(){console.log("removeListener")})),a({type:"client/init",payload:o})}})]})})})},T=(c(118),function(e){e&&e instanceof Function&&c.e(3).then(c.bind(null,124)).then((function(t){var c=t.getCLS,n=t.getFID,s=t.getFCP,a=t.getLCP,o=t.getTTFB;c(e),n(e),s(e),a(e),o(e)}))});o.a.render(Object(d.jsx)(q,{}),document.getElementById("root")),T()},73:function(e,t){},75:function(e,t){}},[[119,1,2]]]);
//# sourceMappingURL=main.3f64819d.chunk.js.map