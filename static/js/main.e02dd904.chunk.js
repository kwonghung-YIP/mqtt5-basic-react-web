(this["webpackJsonpmqtt5-basic-react-web"]=this["webpackJsonpmqtt5-basic-react-web"]||[]).push([[0],{111:function(e,t){},112:function(e,t){},118:function(e,t,n){},119:function(e,t,n){"use strict";n.r(t);var c=n(1),s=n.n(c),a=n(55),r=n.n(a),o=n(4),l=n(2),i=n(23),d=n(0),u=function(e){return Object(d.jsx)("nav",{className:"navbar navbar-expand-md navbar-dark bg-dark",children:Object(d.jsxs)("div",{className:"container-fluid",children:[Object(d.jsx)("div",{className:"navbar-header",children:Object(d.jsx)("span",{className:"navbar-brand",children:"MQTT.js Client for React Web"})}),Object(d.jsx)("div",{className:"collapse navbar-collapse",children:Object(d.jsxs)("ul",{className:"navbar-nav",children:[Object(d.jsx)("li",{className:"nav-item",children:Object(d.jsx)(i.b,{to:"/request_response_pattern",className:"nav-link",children:"Request/Response Pattern"})}),Object(d.jsx)("li",{className:"nav-item",children:Object(d.jsx)(i.b,{to:"/broadcast",className:"nav-link",children:"Boardcast"})})]})})]})})},b=n(6),j=n(123),m=n(24),h=n.n(m),O=n(3),p=s.a.createContext(),x=function(e){return Object(d.jsxs)("div",{className:"mt-2 row",children:[Object(d.jsx)("label",{htmlFor:e.id,className:"col-sm-2 col-form-label",children:e.label}),Object(d.jsx)("div",{className:"col-sm-10",children:Object(d.jsx)("input",{id:e.id,className:"form-control",value:e.value,readOnly:e.readOnly,onChange:function(t){e.onChange(t.target.value)}})})]})},v=function(e){var t=s.a.useContext(p),n=t.client,c=t.connected,a=s.a.useState("request/echo"),r=Object(o.a)(a,2),l=r[0],i=r[1],u=s.a.useState(),m=Object(o.a)(u,2),v=m[0],f=m[1],g=s.a.useState("GoGoGo!"),w=Object(o.a)(g,2),y=w[0],S=w[1],N=s.a.useState("".concat(Object(j.a)())),q=Object(o.a)(N,2),T=q[0],k=q[1],C=s.a.useState(!1),M=Object(o.a)(C,2),R=M[0],Q=M[1],W=s.a.useState([]),I=Object(o.a)(W,2),L=I[0],D=I[1],F=s.a.useRef(L),H=s.a.useRef(1);s.a.useEffect((function(){console.log("reset response topic with new clientId"),null!==n&&n.connected&&f("response/".concat(n.options.clientId,"/echo"))}),[n,c]);var Y=function(e,t){var n={cnt:H.current++,ts:h()().format("HH:mm:ss.SSSSS"),event:e,log:t};F.current=[n].concat(Object(b.a)(F.current)).slice(0,19),D(F.current)},P=function(e,t,n){Y("message",new String(t))},U=function(e){Y("packetsend",JSON.stringify(e))},_=function(e){Y("packetreceive",JSON.stringify(e))},B=function(){if(R){n.unsubscribe(v,{},(function(e){n.removeAllListeners("message"),n.removeAllListeners("packetsend"),n.removeAllListeners("packetreceive"),Q(!1)}))}};return Object(d.jsxs)("div",{children:[Object(d.jsx)(O.a,{when:R,message:function(e,t){return B(),!0}}),Object(d.jsx)("p",{children:"This page demonstrates how to use request response pattern"}),Object(d.jsx)(x,{id:"requestTopic",label:"Request Topic",value:l,readOnly:R,onChange:i}),Object(d.jsx)(x,{id:"responseTopic",label:"Response Topic",value:v,readOnly:R,onChange:f}),Object(d.jsx)(x,{id:"message",label:"Message",value:y,onChange:S}),Object(d.jsx)(x,{id:"correlationData",label:"Correlation Data",value:T,readOnly:!0,onChange:k}),Object(d.jsxs)("div",{className:"mt-2",children:[Object(d.jsx)("button",{className:"btn btn-primary me-2",disabled:!(null!==n&&n.connected&&!R),onClick:function(){if(!R){H.current=1,F.current=[],D(F.current),n.on("message",P),n.on("packetsend",U),n.on("packetreceive",_);n.subscribe(v,{},(function(e,t){Q(!0)}))}},children:"Subscribe"}),Object(d.jsx)("button",{className:"btn btn-primary me-2",disabled:!R,onClick:B,children:"Unsubscribe"}),Object(d.jsx)("button",{className:"btn btn-primary me-2",disabled:!R,onClick:function(){if(R){var e={retain:!0,properties:{responseTopic:v,correlationData:T,payloadFormatIndicator:!0,contentType:"text/plain"}};n.publish(l,y,e,(function(){k("".concat(Object(j.a)()))}))}},children:"Send"})]}),0===L.length?Object(d.jsx)(d.Fragment,{}):Object(d.jsxs)("div",{className:"mt-2",children:[Object(d.jsx)("h5",{children:"Sent/Received package/message"}),Object(d.jsxs)("table",{className:"table table-striped table-sm",children:[Object(d.jsx)("thead",{children:Object(d.jsxs)("tr",{children:[Object(d.jsx)("th",{scope:"col",children:"#"}),Object(d.jsx)("th",{scope:"col",children:"time"}),Object(d.jsx)("th",{scope:"col",children:"event"}),Object(d.jsx)("th",{scope:"col",children:"log"})]})}),Object(d.jsx)("tbody",{children:L.map((function(e,t){return Object(d.jsxs)("tr",{children:[Object(d.jsx)("th",{scope:"row",children:e.cnt}),Object(d.jsx)("td",{children:e.ts}),Object(d.jsx)("td",{children:e.event}),Object(d.jsx)("td",{children:e.log})]},t)}))})]})]})]})},f=n(58),g=function(e){var t=[{url:"ws://test.mosquitto.org:8080/mqtt",desc:"test.mosquitto.org - MQTT over WebSockets, unencrypted, unauthenticated",username:"",password:""},{url:"wss://test.mosquitto.org:8081/mqtt",desc:"test.mosquitto.org - MQTT over WebSockets, encrypted, unauthenticated",username:"",password:""},{url:"ws://test.mosquitto.org:8090/mqtt",desc:"test.mosquitto.org - MQTT over WebSockets, unencrypted, authenticated (rw)",username:"rw",password:"readwrite"},{url:"ws://test.mosquitto.org:8090/mqtt",desc:"test.mosquitto.org - MQTT over WebSockets, unencrypted, authenticated (ro)",username:"ro",password:"readonly"},{url:"ws://test.mosquitto.org:8090/mqtt",desc:"test.mosquitto.org - MQTT over WebSockets, unencrypted, authenticated (wo)",username:"wo",password:"writeonly"},{url:"wss://test.mosquitto.org:8091/mqtt",desc:"test.mosquitto.org - MQTT over WebSockets, encrypted, authenticated (rw)",username:"rw",password:"readwrite"},{url:"wss://test.mosquitto.org:8091/mqtt",desc:"test.mosquitto.org - MQTT over WebSockets, encrypted, authenticated (ro)",username:"ro",password:"readonly"},{url:"wss://test.mosquitto.org:8091/mqtt",desc:"test.mosquitto.org - MQTT over WebSockets, encrypted, authenticated (wo)",username:"wo",password:"writeonly"},{url:"ws://localhost:8000/mqtt",desc:"My local HiveMQ - MQTT over WebSockets, unencrypted, authenticated",username:"user1",password:"hm93bqCj6xR562U"},{url:"wss://localhost:8001/mqtt",desc:"My local HiveMQ - MQTT over WebSockets, encrypted, authenticated",username:"user1",password:"hm93bqCj6xR562U"}],n=s.a.useState("webclient_".concat(Math.random().toString(16).substr(2,8))),c=Object(o.a)(n,2),a=c[0],r=(c[1],s.a.useState(t[9].url)),l=Object(o.a)(r,2),i=l[0],u=l[1],b=s.a.useState(t[9].username),j=Object(o.a)(b,2),m=j[0],h=j[1],O=s.a.useState(t[9].password),v=Object(o.a)(O,2),g=v[0],y=v[1],S=s.a.useRef(null),N=s.a.useContext(p).connected;return s.a.useEffect((function(){null===S.current&&(S.current=new f.a(document.getElementById("connectDialogue"),{backdrop:"static",keyboard:!1,focus:!0}))}),[]),s.a.useEffect((function(){N?S.current.hide():S.current.show()}),[N]),Object(d.jsx)("div",{className:"modal",tabIndex:"-1",id:"connectDialogue",children:Object(d.jsx)("div",{className:"modal-dialog modal-lg modal-dialog-centered",children:Object(d.jsxs)("div",{className:"modal-content",children:[Object(d.jsx)("div",{className:"modal-header",children:Object(d.jsx)("h5",{className:"modal-title",children:"MQTT.js client properties"})}),Object(d.jsxs)("div",{className:"modal-body",children:[Object(d.jsx)(x,{id:"clientId",label:"Client ID",value:a,readOnly:!0}),Object(d.jsx)(w,{id:"profile",label:"Profile",data:t,selected:9,onChange:function(e){u(e.url),h(e.username),y(e.password)}}),Object(d.jsx)(x,{id:"brokerUrl",label:"BrokerUrl",value:i,onChange:u}),Object(d.jsx)(x,{id:"username",label:"Username",value:m,onChange:h}),Object(d.jsx)(x,{id:"password",label:"Password",value:g,onChange:y})]}),Object(d.jsx)("div",{className:"modal-footer",children:Object(d.jsx)("button",{type:"button",className:"btn btn-primary",onClick:function(){e.connect(a,i,m,g)},children:"Connect"})})]})})})},w=function(e){var t=s.a.useState(e.selected),n=Object(o.a)(t,2),c=n[0],a=n[1];return Object(d.jsxs)("div",{className:"mt-2 row",children:[Object(d.jsx)("label",{htmlFor:e.id,className:"col-sm-2 col-form-label",children:e.label}),Object(d.jsx)("div",{className:"col-sm-10",children:Object(d.jsx)("select",{id:e.id,className:"form-select",value:c,onChange:function(t){a(t.target.value),e.onChange(e.data[t.target.value])},children:e.data.map((function(e,t){return Object(d.jsx)("option",{value:t,children:e.desc},t)}))})})]})},y=function(e){var t=s.a.useContext(p),n=t.client,a=(t.connected,Object(c.useState)("measure/latency")),r=Object(o.a)(a,2),l=r[0],i=r[1],u=s.a.useState(!1),j=Object(o.a)(u,2),m=j[0],v=j[1],f=s.a.useState([]),g=Object(o.a)(f,2),w=g[0],y=g[1],S=s.a.useRef(w),N=s.a.useRef(1),q=function(e,t,n){var c=JSON.parse(t),s=h()(c.sentTime),a=h()(),r=a.valueOf()-s.valueOf();!function(e){S.current=[e].concat(Object(b.a)(S.current)).slice(0,19),y(S.current)}({cnt:c.count,sent:s.format("D/M/YYYY[T]HH:mm:ss.SSSSS"),recv:a.format("D/M/YYYY[T]HH:mm:ss.SSSSS"),delay:r})},T=function(){if(m){n.unsubscribe(l,{},(function(e){n.removeAllListeners("message"),v(!1)}))}};return Object(d.jsxs)("div",{children:[Object(d.jsx)(O.a,{when:m,message:function(e,t){return T(),!0}}),Object(d.jsx)(x,{id:"broadcastTopic",label:"Boardcast Topic",value:l,readOnly:m,onChange:i}),Object(d.jsxs)("div",{className:"mt-2",children:[Object(d.jsx)("button",{className:"btn btn-primary me-2",disabled:!(null!==n&&n.connected&&!m),onClick:function(){if(!m){N.current=1,S.current=[],y(S.current),n.on("message",q);n.subscribe(l,{},(function(e,t){v(!0)}))}},children:"Subscribe"}),Object(d.jsx)("button",{className:"btn btn-primary me-2",disabled:!m,onClick:T,children:"Unsubscribe"})]}),0==w.length?Object(d.jsx)(d.Fragment,{}):Object(d.jsxs)("div",{className:"mt-2",children:[Object(d.jsx)("h5",{children:"Received message"}),Object(d.jsxs)("table",{className:"table table-striped table-sm",children:[Object(d.jsx)("thead",{children:Object(d.jsxs)("tr",{children:[Object(d.jsx)("th",{scope:"col",children:"#"}),Object(d.jsx)("th",{scope:"col",children:"sent time"}),Object(d.jsx)("th",{scope:"col",children:"received time"}),Object(d.jsx)("th",{scope:"col",children:"delay"})]})}),Object(d.jsx)("tbody",{children:w.map((function(e,t){return Object(d.jsxs)("tr",{children:[Object(d.jsx)("td",{scope:"row",children:e.cnt}),Object(d.jsx)("td",{children:e.sent}),Object(d.jsx)("td",{children:e.recv}),Object(d.jsx)("td",{children:e.delay})]},t)}))})]})]})]})},S=n(68),N=function(e,t){var n=t.type,c=t.payload;return"client/init"===n?Object(l.a)(Object(l.a)({},e),{},{client:c}):"client/close"===n||"client/end"===n?Object(l.a)(Object(l.a)({},e),{},{client:null}):Object(l.a)({},e)},q=function(e){var t=s.a.useReducer(N,{client:null}),n=Object(o.a)(t,2),c=n[0],a=n[1];return Object(d.jsx)("div",{className:"container",children:Object(d.jsx)(p.Provider,{value:{client:c.client,connected:null!==c.client&&c.client.connected},children:Object(d.jsxs)(i.a,{children:[Object(d.jsx)(u,{}),Object(d.jsxs)(O.e,{children:[Object(d.jsx)(O.c,{path:"/",exact:!0,children:Object(d.jsx)(O.b,{to:"/request_response_pattern"})}),Object(d.jsx)(O.c,{path:"/request_response_pattern",children:Object(d.jsx)(v,{})}),Object(d.jsx)(O.c,{path:"/broadcast",children:Object(d.jsx)(y,{})})]}),Object(d.jsx)(g,{connect:function(e,t,n,s){var r=c.client;if(null!==r&&r.connected)throw new Error("Client has already been connected");(r=S.connect(t,{clientId:e,reconnectPeriod:0,protocolVersion:5,username:n,password:s})).on("error",(function(e){throw e})),r.on("connect",(function(e){a({type:"client/connect",payload:e})})),r.on("disconnect",(function(e){console.log("client disconnect")})),r.on("offline",(function(){console.log("client offline")})),r.on("reconnect",(function(){console.log("client reconnect")})),r.on("close",(function(){console.log("client close"),a({type:"client/close",payload:r})})),r.on("end",(function(){console.log("client end"),a({type:"client/end",payload:r})})),r.on("newListener",(function(){console.log("newListener")})),r.on("removeListener",(function(){console.log("removeListener")})),a({type:"client/init",payload:r})}})]})})})},T=(n(118),function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,124)).then((function(t){var n=t.getCLS,c=t.getFID,s=t.getFCP,a=t.getLCP,r=t.getTTFB;n(e),c(e),s(e),a(e),r(e)}))});r.a.render(Object(d.jsx)(q,{}),document.getElementById("root")),T()},73:function(e,t){},75:function(e,t){}},[[119,1,2]]]);
//# sourceMappingURL=main.e02dd904.chunk.js.map